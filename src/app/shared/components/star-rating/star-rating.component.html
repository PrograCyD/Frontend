<div
  class="star-rating"
  [class.readonly]="readonly"
  [class]="getSizeClass()"
  (mouseleave)="onMouseLeave()"
>
  @for (star of stars; track star) {
    <button
      type="button"
      class="star"
      [class.interactive]="!readonly"
      [attr.aria-label]="'Rate ' + star + ' stars'"
      (click)="onStarClick($event, star)"
      (mouseenter)="onStarHover(star)"
      [disabled]="readonly"
    >
      @switch (getStarType(star)) {
        @case ('full') {
          <!-- Full Star -->
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
          </svg>
        }
        @case ('half') {
          <!-- Half Star -->
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <defs>
              <linearGradient id="half-fill-{{star}}">
                <stop offset="50%" stop-color="currentColor"/>
                <stop offset="50%" stop-color="transparent"/>
              </linearGradient>
            </defs>
            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
                  [attr.fill]="'url(#half-fill-' + star + ')'" stroke="currentColor" stroke-width="1"/>
          </svg>
        }
        @default {
          <!-- Empty Star -->
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
          </svg>
        }
      }
    </button>
  }

  @if (!readonly && rating > 0) {
    <span class="rating-value">{{ rating.toFixed(1) }}</span>
  }
</div>
